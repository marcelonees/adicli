#!/bin/bash

#database=vigsan_fisc
#table=legislacao
#model=VigSanFiscLegislacao

database=$1
table=$2
model=$3

function infobox() {
   echo "Uso: $0 database table model"
   echo "Ex: $0 vigsan_fisc legislacao VigSanFiscLegislacao"
   exit 1
}

if [ "X${database}" == "X" ] || [ "X${table}" == "X" ] || [ "X${model}" == "X" ]; then
  infobox
fi

. /etc/adicli/adicli.conf

template_model=${template_model:-"/usr/share/adicli/framework/templates/model/Model.php"}
template_list=${template_model:-"/usr/share/adicli/framework/templates/list/CompleteList.php"}
template_form=${template_model:-"/usr/share/adicli/framework/templates/form/CompleteForm.php"}

echo 
echo "ATENÇÂO! Este comando irá criar os arquivos dentro dos diretórios app/control/$database/$table/ e app/model/$database/$table/"
echo "Aperte ENTER para continuar ou CTRL+C para cancelar"
echo 
read x

mkdir -p app/model/$database/$table/
mkdir -p app/control/$database/$table/

# Cria o modelo
adicli -c /etc/adicli/databases/$database.conf \
       -A "Marcelo Barreto Nees <marcelo.linux@gmail.com>" \
       -t $table -M $model -C ${model} -T /usr/share/adicli/framework/templates/model/ModelPmjs.php > app/model/$database/$table/$model.class.php

# Cria o arquivo de listagem
adicli -c /etc/adicli/databases/$database.conf \
       -A "Marcelo Barreto Nees <marcelo.linux@gmail.com>" \
       -t $table -M $model -C ${model}List -T /usr/share/adicli/framework/templates/list/CompletePmjsList.php > app/control/$database/$table/${model}List.class.php

# Cria o form
adicli -c /etc/adicli/databases/$database.conf \
       -A "Marcelo Barreto Nees <marcelo.linux@gmail.com>" \
       -t $table -M $model -C ${model}Form -T /usr/share/adicli/framework/templates/form/CompletePmjsForm.php > app/control/$database/$table/${model}Form.class.php


